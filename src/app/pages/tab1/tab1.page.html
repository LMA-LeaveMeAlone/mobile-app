<ion-content [fullscreen]="true">
  <div class="title">
    <h1>Interagir avec la porte</h1>
    <ion-icon name="exit-outline" (click)="disconnect()"></ion-icon>
  </div>

  <!-- Door interaction -->
  <ion-card>
    <ion-card-header>
      <ion-card-title>Interagir</ion-card-title>
    </ion-card-header>
    <ion-card-content class="interaction-card">
      <ion-button (click)="toggleAlarm()" [class.button-disabled]="btnAlarmDisabled">
        <ion-icon name="notifications-outline" *ngIf="isAlarming() === true"></ion-icon>
        <ion-icon name="notifications-off-outline" *ngIf="isAlarming() !== true"></ion-icon>
        <p>Alarme</p>
      </ion-button>
      <ion-button (click)="toggleLight()">
        <ion-icon name="flash-outline" *ngIf="isLighting() === true"></ion-icon>
        <ion-icon name="flash-off-outline" *ngIf="isLighting() !== true"></ion-icon>
        <p>Lumière</p>
      </ion-button>
      <ion-button (click)="this.microphoneIsEnabled = !this.microphoneIsEnabled">
        <ion-icon name="mic-outline" *ngIf="microphoneIsEnabled === true"></ion-icon>
        <ion-icon name="mic-off-outline" *ngIf="microphoneIsEnabled !== true"></ion-icon>
        <p>Parler</p>
      </ion-button>
      <ion-button (click)="this.cameraIsEnabled = !this.cameraIsEnabled">
        <ion-icon name="eye-outline" *ngIf="cameraIsEnabled === true"></ion-icon>
        <ion-icon name="eye-off-outline" *ngIf="cameraIsEnabled !== true"></ion-icon>
        <p>Voir</p>
      </ion-button>
    </ion-card-content>
  </ion-card>

  <!-- Camera view -->
  <ion-card>
    <div class="signal"
      [ngStyle]="{'background-color': cameraIsEnabled === true ? 'var(--ion-color-success)' : 'var(--ion-color-danger)' }">
    </div>
    <ion-card-header>
      <ion-card-title>Caméra</ion-card-title>
      <div *ngIf="cameraIsEnabled !== true">
        <p>La caméra est coupée. <br />Activez-la pour avoir un aperçu de ce qu'il se passe devant votre porte.</p>
      </div>
    </ion-card-header>
    <ion-card-content *ngIf="cameraIsEnabled === true">
      <video width="100%" autoplay playsinline style="pointer-events: none;" loop>
        <source src="https://aws-lma-video-records.s3.eu-west-3.amazonaws.com/house_id_1/2022_4_8_14_39_4.mp4"
          type="video/mp4">
      </video>
    </ion-card-content>
  </ion-card>

  <!-- Recents activity -->
  <ion-card>
    <ion-card-header>
      <ion-card-title>Dernières activités</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <div *ngIf="recents">
        <swiper [slidesPerView]=2.5 [spaceBetween]=10 #swiper>
          <ng-template swiperSlide *ngFor="let r of recents | slice:0:5; let i = index">
            <div class="info-card" (click)="showVideo(i)">
              <p class="entity">{{ r.message }}</p>
              <p>
                {{ r.datetime | date:'dd/MM/yyyy'}}<br>
                {{ r.datetime | date:'hh:mm:ss'}}
              </p>
            </div>
          </ng-template>
        </swiper>
      </div>
      <div *ngIf="!recents">
        <p>Aucune entité n'a été détecté pour le moment.</p>
      </div>
    </ion-card-content>
  </ion-card>
</ion-content>